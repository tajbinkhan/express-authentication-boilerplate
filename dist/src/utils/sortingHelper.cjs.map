{"version":3,"sources":["../../../src/utils/sortingHelper.ts"],"sourcesContent":["import { SQL, asc, desc } from \"drizzle-orm\";\nimport { PgTableWithColumns } from \"drizzle-orm/pg-core\";\n\nexport class SortingHelper<T extends PgTableWithColumns<any>> {\n\tprivate model: T;\n\tprivate sortableFields: Record<string, SQL>;\n\n\tconstructor(model: T) {\n\t\tthis.model = model;\n\t\tthis.sortableFields = this.getDynamicSortFields();\n\t}\n\n\tprivate getDynamicSortFields(): Record<string, SQL> {\n\t\tconst fields: Record<string, SQL> = {};\n\n\t\tfor (const [key, column] of Object.entries(this.model)) {\n\t\t\tif (typeof column === \"object\" && \"name\" in column) {\n\t\t\t\tfields[key] = column;\n\t\t\t}\n\t\t}\n\n\t\treturn fields;\n\t}\n\n\tpublic getValidSortFields(): string[] {\n\t\treturn Object.keys(this.sortableFields);\n\t}\n\n\tpublic applySorting(sortMethod?: string, sortBy?: string): SQL | undefined {\n\t\tif (!sortMethod) return desc(this.model.id);\n\n\t\tconst sortField = this.sortableFields[sortMethod];\n\n\t\tif (!sortField) return desc(this.model.id);\n\n\t\tconst sortDirection = sortBy?.toLowerCase() === \"asc\" ? asc : desc;\n\t\treturn sortDirection(sortField);\n\t}\n\n\tpublic isValidSortMethod(sortMethod: string): boolean {\n\t\treturn sortMethod in this.sortableFields;\n\t}\n\n\tpublic isValidSortDirection(sortBy: string): boolean {\n\t\treturn [\"asc\", \"desc\"].includes(sortBy.toLowerCase());\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAA+B;AAGxB,IAAM,gBAAN,MAAuD;AAAA,EACrD;AAAA,EACA;AAAA,EAER,YAAY,OAAU;AACrB,SAAK,QAAQ;AACb,SAAK,iBAAiB,KAAK,qBAAqB;AAAA,EACjD;AAAA,EAEQ,uBAA4C;AACnD,UAAM,SAA8B,CAAC;AAErC,eAAW,CAAC,KAAK,MAAM,KAAK,OAAO,QAAQ,KAAK,KAAK,GAAG;AACvD,UAAI,OAAO,WAAW,YAAY,UAAU,QAAQ;AACnD,eAAO,GAAG,IAAI;AAAA,MACf;AAAA,IACD;AAEA,WAAO;AAAA,EACR;AAAA,EAEO,qBAA+B;AACrC,WAAO,OAAO,KAAK,KAAK,cAAc;AAAA,EACvC;AAAA,EAEO,aAAa,YAAqB,QAAkC;AAC1E,QAAI,CAAC,WAAY,YAAO,yBAAK,KAAK,MAAM,EAAE;AAE1C,UAAM,YAAY,KAAK,eAAe,UAAU;AAEhD,QAAI,CAAC,UAAW,YAAO,yBAAK,KAAK,MAAM,EAAE;AAEzC,UAAM,gBAAgB,QAAQ,YAAY,MAAM,QAAQ,yBAAM;AAC9D,WAAO,cAAc,SAAS;AAAA,EAC/B;AAAA,EAEO,kBAAkB,YAA6B;AACrD,WAAO,cAAc,KAAK;AAAA,EAC3B;AAAA,EAEO,qBAAqB,QAAyB;AACpD,WAAO,CAAC,OAAO,MAAM,EAAE,SAAS,OAAO,YAAY,CAAC;AAAA,EACrD;AACD;","names":[]}